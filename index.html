<!DOCTYPE html>
<html>
    <head>
        <script>
            var initialised=false
            var Mandelbrot={
                onRuntimeInitialized:()=>{
                    initialised=true
                }
            }
        </script>
        <script src="mandelbrot/workers/mandelbrot.js"></script>
        <script src="dragdrop.js"></script>
        <script src="main.js" defer></script>
        <script src="palette.js" defer></script>
        <script src="webm.js" async></script>
        <script src="video.js" async></script>
        <link rel="stylesheet" href="index.css">
        <title>Mandelbrot Explorer</title>
    </head>
    <body>
        <div id="maincontent">
            <div id="top">

            </div>
            <div id="mid">
                <div id="canvcontainer" class="vertical">
                    <canvas id="render" width="800" height="600" tabindex="0"></canvas>
                </div>
                <div style="width:7px;background:#555"></div>
                <div id="sidebar">
                    <button onclick="saveImg()">Download</button>
                    <button onclick="showDiv('paletteEditor')">1</button>
                    <button onclick="showDiv('video')">2</button>

                    <div><div class="inpLabel">Iters:</div><input style="width:70px" type="number" oninput="Mandelbrot.updateWorkers({iters:+this.value|0})"></div>
                    <div><div class="inpLabel">Width:</div><input style="width:70px" type="number" max="10000" onchange="updateDims(+this.value,Mandelbrot.height)"></div>
                    <div><div class="inpLabel">Height:</div><input style="width:70px" type="number" max="10000" onchange="updateDims(Mandelbrot.width,+this.value)"></div>
                    <div><div class="inpLabel">Real:</div><input style="width:70px" type="number" max="10000" onchange="updateCoords(+this.value,Mandelbrot.cy,Mandelbrot.depth)"></div>
                    <div><div class="inpLabel">Imag:</div><input style="width:70px" type="number" max="10000" onchange="updateCoords(Mandelbrot.cx,+this.value,Mandelbrot.depth)"></div>
                    <div><div class="inpLabel">Depth:</div><input style="width:70px" type="number" max="10000" onchange="updateCoords(Mandelbrot.cx,Mandelbrot.cy,+this.value)"></div>
                </div>
            </div>
            <div id="xhandle">&nbsp;</div>
            <div id="bottom">
                <div id="paletteEditor">
                    <div style="width:750px;padding-left:15px">
                        <div id="paletteDisplay">
                            <canvas id="paletteGradient" width="700" height="30"></canvas>
                            <div id="colStops"></div>
                        </div>
                        <div id="curStop" style="display:flex;width:700px">
                            <div>
                                Stop offset: <input type="number" min="0" max="1" step=".01" id="stopOffset">
                            </div>
                            <div>
                                Stop colour: <input type="color" id="stopColour">
                            </div>
                        </div>

                        <button onclick="randomPalette()">Random palette</button>
                        
                        <div style="margin-top:20px">Palette Length: <input type="number" id="lengthInput"></div>
                    </div>
                </div>
                <div id="video">
                    <div id="vidTimeline">
                        <canvas id="animVisual" width="1400" height="200" style="width:700px"></canvas>
                        <div id="animStops"></div>
                    </div>
                    <div><div>Parameter: <input type="number" id="stopParam"></div>
                    <button type="number" id="addStop">Add stop</button>


                    <div><div>
                        Video duration:
                        <input type="number" id="vidDuration">
                    </div>
                    <div>
                        FPS:
                        <input type="number" id="vidFPS" value="30" min="1" max="120">
                    </div>

                    <button onclick="record()">Apply</button>
                </div>
            </div>
        </div>
    </body>
</html>
